=========Malware (1)==========
Type: Trojan
Name: Shutup.exe
Analysis Result:
1. Static:
- Using PEStudio:
  1. Indicators: Score of VirusTotal
  2. Flagged Section (from here on will be added marked (x)) : 
    2.1 Libraries: Cabinet.dll (x) == obfucation // change how a program operates
                   ADVAPI32.dll == API used on registry calls
                   KERNEL32.dll == Operating system modules
                   GDI32.dll == Graphics Device Interface Libraries
                   USER32.dll == User Interface Libraries
                   msvcrt.dll == C/C++ Libraries which required in some software functions
                   COMCTL32.dll == Control Libraries
                   VERSION.dll == Checks file versions to be operated

   2.2 Imports:    GetDesktopWindow (x)
                   FreeSid (x)
                   OpenProcessToken (x)
                   LookupPrivilegeValueA (x)
                   AllocateAndInitializeSid (x)
                   EqualSid (x)
                   AdjustTokenPrivileges (x)
                   EnumResourceLanguageA (x)
                   RegDeleteValueA (x)
                   RegSetValueA (x)
                   RegCreateKeyExA (x)
                   WritePrivateProfileStringA (x)
                   GetCurrentProcessId (x)
                   20 (FDI Create) (x)
                   21 (FDIIsCabinet) (x)
                   23 (FDIDestroy) (x)
                   22 (FDICopy) (x)
                   DeleteFileA (x)
                   SetFileAttributeA (x)
                   RemoveDirectoryA (x)
                   WriteFile (x)
                   GetTempFileNameA (x)
                   FindNextFileA (x)
                   FindFirstFileA (x)
                   CreateProcessA (x)
                   GetExitCodeProcess (x)
                   TerminateProcess (x)
                   GetCUrrentThreadId (x)
                   ExitWindowsEx (x)
                   SetCurrentDirectoryA (x)
                   RtLookupFunctionEntry (x)

  3. Payloads/Suspicious Functions can be seen in Dynamic Analysis that it creates a new proccess cmd.exe and then WSCRIPT.exe where it is needed to run the .vbs
     scipts to show pop ups (spam popups). Files exported from Procmon to be used in ProcDOT is attached on the name Log Shutup.csv.
     (x) WriteFile C:\Users\malware research\AppData\Local\Temp\IXP007.TMP\box.vbs
     (x) ProcessCreate C:\Windows\system32\cmd.exe
     (x) RegSetValue HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-1830721051-3012993092-1685138979-1002\\Device\HarddiskVolume3\Windows\System32\cmd.exe (autostart)
     (x) cmd.exe has thread 1704, create process WScript.exe to run C:\Users\malware research\AppData\Local\Temp\IXP000.TMP\box.vbs

  4. Ways to Immobilize:
      - BP VirtualAlloc (Set Breakpoints to Virtual Alloc where memory starts to be prepared before functions are operated.
      - Step Over to run functions one by one / step by step.
      - Watch Differences in RAX Value that indicates a return value after a functions has been running.
      - Change Operations (Right After a return value has been changed or on Sub & Add operations to NOP (No Operations) by pressing Space on X64dbg/X32dbg.
      - Conditions found to exit and break the entire malware functions is _amsg_exit from Ghidra.
      - The required variables (DAT_14000cb80) is compared to 0x1, so patch is available according to the condition by changing the 0x1 to 0x0 to match the RAX when it reached the requeired comparison function.

