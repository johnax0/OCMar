=========Malware (2)==========
Type: Trojan
Name: Youareanidiot.exe
Analysis Result:
1. Static:
- Using PEStudio:
  1. Indicators: Use of mscoree.dll
  2. Flagged Section (from here on will be added marked (x)) : 
    2.1 Libraries: mscoree (x) == launch Microsoft Edge and Visit predefined URL(s)
    2.2 Imports:    YouAreAnIdiot (x)
                    YouAreAnIdiot.exe (x)
                    YouAreAnIdiot.Form1.Resources (x)
                    YouAreAnIdiot.Properties.Resources.resources (x)
                    timer1.tick (x)
                    timer2.tick (x)
                    timer3.tick (x)

  3. Payloads/Suspicious Functions can be seen in Dynamic Analysis that it creates a new proccess msedge.exe and then visits certain URL(s) to be shown and respawned as many as possible until system crashed. Files exported from Procmon to be used in ProcDOT is attached on the name LogfileYAAI.csv.
     (x) Google Chrome.exe has PID of 6364, create process msedge.exe (PID 4740) to create run C:\Users\malware research\AppData\Local\Microsoft\Edge\User Data\Defauls\Service Worker\CahceStorage\3cedfb74d44f2e84198d23075aef16c34a668ceb\deb88197-1eb9-4035-b6b8-dc19f6031b078f4e63ea72962af1_0   
     (x) WriteFile HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Content\CachePrefix
     (x) WriteFile C:\Users\malware research\AppData\Local\Microsoft\Windows\INetCache\IE\YQO18VNG\dnserrordiagoll[2]
     (x) ProcessCreate C:\Windows\system32\cmd.exe
     (x) RegSetValue HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-1830721051-3012993092-1685138979-1002\\Device\HarddiskVolume3\Windows\System32\cmd.exe (autostart)
    
  4. Ways to Immobilize:
      - BP VirtualAlloc (Set Breakpoints to Virtual Alloc where memory starts to be prepared before functions are operated.
      - Step Over to run functions one by one / step by step.
      - Watch Differences in RAX Value that indicates a return value after a functions has been running.
      - Change Operations (Right After a return value has been changed or on Sub & Add operations to NOP (No Operations) by pressing Space on X64dbg/X32dbg.
      - Conditions found to exit and break the entire malware functions is _amsg_exit from Ghidra.
      - The required variables (DAT_14000cb80) is compared to 0x1, so patch is available according to the condition by changing the 0x1 to 0x0 to match the RAX when it reached the requeired comparison function.
